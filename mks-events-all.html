<!DOCTYPE html>
<html lang="cs"><head>
<meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1">
<title>Program akc√≠</title>
<meta name="color-scheme" content="light">
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
<style>
:root{
  --bg:#fff6f2; --card:#fff; --text:#202225; --muted:#555; --chip:#f5f6fa; --divider:#e8e8ee;
  --rail:56px;
}
*{box-sizing:border-box}
body{ margin:0;padding:16px;background:linear-gradient(180deg,var(--bg),#fff0ec);
      color:var(--text);font:16px/1.7 "Inter",system-ui,-apple-system,Segoe UI,Roboto,Ubuntu }
.wrapper{max-width:980px;margin:0 auto}
.grid{display:grid;gap:16px;grid-template-columns:1fr}

/* karta + kolejnice */
.card{
  position:relative;
  display:flex; gap:18px; align-items:stretch;
  background:var(--card); border-radius:16px; padding:18px;
  padding-left:calc(18px + var(--rail));
  box-shadow:0 6px 24px rgba(0,0,0,.08);
  transition: transform .15s ease, box-shadow .2s ease;
}
.card::before{ content:""; position:absolute; left:0; top:0; bottom:0; width:var(--rail);
  background:var(--bar,#f4a261); border-radius:16px 0 0 16px; }
.card::after{ content:attr(data-calendar); position:absolute; left:0; top:0; bottom:0; width:var(--rail);
  display:flex; align-items:center; justify-content:center; writing-mode:vertical-rl; text-orientation:mixed;
  color:#fff; font-weight:700; letter-spacing:.3px; padding:8px 0; text-align:center; overflow:hidden; opacity:.95; }
.card:hover{ transform:translateY(-2px); box-shadow:0 10px 30px rgba(0,0,0,.12); }

/* plak√°t */
.media{ flex:0 0 340px; max-width:340px; align-self:flex-start; }
.poster-wrap{ background:#fff; border-radius:12px; overflow:hidden; border:1px solid rgba(0,0,0,.06);
              box-shadow:0 4px 12px rgba(0,0,0,.06); cursor: zoom-in; }
.poster{ display:block; width:100%; height:auto; max-height:640px; transition:.3s transform,.3s filter; }
.card:hover .poster{ transform:scale(1.03); filter:brightness(1.05); }

/* prav√Ω sloupec */
.body{flex:1; min-width:0; display:flex; flex-direction:column;}

/* META: vpravo ‚Äì üìçM√≠sto ‚Üí üìÖDatum ‚Üí ‚è∞ƒåas, v≈°e jako badge */
.meta{
  display:flex; align-items:center; gap:10px; padding:10px 0;
  border-bottom:1px solid var(--divider); justify-content:flex-end; flex-wrap:wrap;
}
.badge{
  display:inline-block; background:var(--chip); color:#3d4051;
  border-radius:6px; padding:4px 10px; font-size:14px; font-weight:600;
}
.badge--location{}

/* TITULEK a POPIS ‚Äì bez ƒçar */
.title{ margin:0; padding:12px 0 6px; font-size:26px; line-height:1.25; font-weight:700; }
.desc{ color:#2a2d3a; font-size:17px; padding:6px 0 12px; }

/* tlaƒç√≠tka ‚Äì ƒç√°ra jen tady */
.actions{
  margin-top:auto; display:flex; flex-wrap:wrap; gap:10px; justify-content:center; width:100%;
  border-top:1px solid var(--divider); padding-top:12px;
  container-type:inline-size; /* pro container query */
}
.btn{
  display:inline-flex; align-items:center; gap:8px;
  border:1px solid rgba(0,0,0,.1); background:#fff;
  padding:8px 12px; border-radius:10px; font-weight:600; font-size:14px;
  box-shadow:0 2px 8px rgba(0,0,0,.04);
  cursor:pointer; color:#1a1f36;
  text-decoration:none;             /* NEpodtrh√°vat */
}
.btn:hover,.btn:focus{ text-decoration:none }      /* p≈ôepi≈° glob√°ln√≠ a:hover */
.btn .ico{ font-size:16px; line-height:1; text-decoration:none }
.btn .label{ display:inline }

/* ‚Äî‚Äî Compact tlaƒç√≠tka (jen ikonky) ‚Äî ƒçistƒõ CSS ‚Äî‚Äî */
@supports (container-type: inline-size) {
  @container (max-width: 440px) {
    .actions{ gap:12px }
    .actions .btn{ padding:10px; width:44px; height:44px; border-radius:12px }
    .actions .btn .label{ display:none }
    .actions .btn .ico{ font-size:20px }
  }
}
@supports not (container-type: inline-size) {
  @media (max-width: 520px){
    .actions{ gap:12px }
    .actions .btn{ padding:10px; width:44px; height:44px; border-radius:12px }
    .actions .btn .label{ display:none }
    .actions .btn .ico{ font-size:20px }
  }
}

/* barvy podle kalend√°≈ôe */
.card[data-calendar*="KD"]{ --bar:#e76f51; }
.card[data-calendar*="Hamr"]{ --bar:#2a9d8f; }
.card[data-calendar*="Taneƒçn√≠"]{ --bar:#e9c46a; }
.card[data-calendar*="Sviny"]{ --bar:#264653; }

/* responsive */
@media (max-width:740px){
  .card{ flex-direction:column; --rail:42px; }
  .card::after{ font-size:12px; }
  .media{ flex:unset; max-width:100% }
}

/* glob√°ln√≠ odkazy */
a{ color:#0b69d7; text-decoration:none }
a:hover{ text-decoration:underline }
/* ‚Ä¶ale tlaƒç√≠tka NIKDY nepodtrh√°vat */
.actions .btn, .actions .btn:hover, .actions .btn:focus{ text-decoration:none }
</style>

</head>
<body>
  <div class="wrapper">
    <div class="grid" id="grid"><p>≈Ω√°dn√© akce.</p></div>
    <div id="load-more-sentinel" style="height:1px"></div>
  </div>

  <div class="lightbox" id="lightbox" aria-hidden="true"><img id="lightbox-img" alt=""></div>

<script>
window.__REST_EVENTS = [];

/* helpers */
function h(s){return String(s||'').replace(/[&<>]/g,c=>({'&':'&amp;','<':'&lt;','>':'&gt;'}[c]))}
function ha(s){return h(s).replace(/"/g,'&quot;')}
function slugify(s){return (s||'').normalize('NFD').replace(/[\u0300-\u036f]/g,'').toLowerCase().replace(/[^a-z0-9]+/g,'-').replace(/^-+|-+$/g,'')||'akce'}

/* karta */
function renderCardHTML(d){
  var media = d.image
    ? '<div class="media"><div class="poster-wrap"><img class="poster" loading="lazy" decoding="async" src="'+ha(d.image)+'" alt=""></div></div>'
    : '';
  var meta = '<div class="meta">'+
               (d.location ? '<span class="badge badge--location">üìç '+h(d.location)+'</span>' : '')+
               '<span class="badge">üìÖ '+h(d.dateBadge)+'</span>'+
               (d.showTime ? ' <span class="badge">‚è∞ '+h(d.timeText)+'</span>' : '')+
             '</div>';
  var title = '<h2 class="title">'+h(d.title)+'</h2>';
  var desc  = d.details? '<div class="desc">'+h(d.details)+'</div>' : '';

  const gtxt = 'P≈ôidat do Google kalend√°≈ôe';
  const atxt = 'P≈ôidat do Apple kalend√°≈ôe';

  return '<article class="card" data-calendar="'+ha(d.calendar)+'">'+
           media+
           '<div class="body">'+
             meta + title + desc +
             '<div class="actions">'+
               '<a class="btn" href="'+ha(d.gcalUrl)+'" target="_blank" rel="noopener" title="'+ha(gtxt)+'"><span class="ico">üóìÔ∏è</span> <span class="label">'+h(gtxt)+'</span></a>'+
               '<a class="btn" href="'+ha(d.icsDataUri)+'" download="'+ha(slugify(d.title))+'.ics" title="'+ha(atxt)+'"><span class="ico">üçé</span> <span class="label">'+h(atxt)+'</span></a>'+
             '</div>'+
           '</div>'+
         '</article>';
}

/* iFrame resize */
function sendHeight(){var h=document.body.scrollHeight; parent&&parent.postMessage&&parent.postMessage({type:'resize-iframe',height:h},'*');}
window.addEventListener('load',sendHeight);
window.addEventListener('resize',sendHeight);
setTimeout(sendHeight,300);

/* Lightbox */
(function(){var box=document.getElementById('lightbox'),img=document.getElementById('lightbox-img');
  document.addEventListener('click',function(e){var t=e.target;
    if(t&&t.tagName==='IMG'&&t.classList.contains('poster')){img.src=t.currentSrc||t.src;box.classList.add('open');box.setAttribute('aria-hidden','false');e.preventDefault();}
    else if(t===box){box.classList.remove('open');box.setAttribute('aria-hidden','true');img.src='';}
  });
  document.addEventListener('keydown',function(e){if(e.key==='Escape'){box.classList.remove('open');box.setAttribute('aria-hidden','true');img.src='';}});
})();

/* fallback: kdy≈æ se obr√°zek nenaƒçte */
document.addEventListener('error',function(e){
  var t=e.target; if(t&&t.tagName==='IMG'&&t.classList.contains('poster')){
    var wrap=t.closest('.media'); if(wrap) wrap.style.display='none'; sendHeight();
  }
},true);

/* Lazy render */
(function(){
  var data = Array.isArray(window.__REST_EVENTS)? window.__REST_EVENTS.slice():[];
  if(!data.length) return;
  var grid = document.getElementById('grid');
  var sent = document.getElementById('load-more-sentinel');
  var CHUNK = 6;

  function appendChunk(){
    var part=data.splice(0,CHUNK); if(!part.length) return;
    var html=part.map(renderCardHTML).join(''); var tmp=document.createElement('div'); tmp.innerHTML=html;
    while(tmp.firstChild) grid.appendChild(tmp.firstChild);
    sendHeight();
  }
  appendChunk();
  var io=new IntersectionObserver(function(es){
    es.forEach(function(ent){ if(ent.isIntersecting){ appendChunk(); if(!data.length){ io.disconnect(); sent.remove(); } } });
  },{root:null,rootMargin:'600px 0px',threshold:0});
  io.observe(sent);
})();
</script>
</body></html>